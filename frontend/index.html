<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KWASU Lost & Found Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        /* All your existing CSS styles remain the same */
        :root {
            --primary-color: #1a5276;
            --secondary-color: #2980b9;
            --accent-color: #f39c12;
            --light-bg: #ecf0f1;
            --supporter-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --info-color: #3498db;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: #333;
            padding-top: 0;
        }
        
        /* All your existing CSS styles remain unchanged */
        .sticky-header {
            position: fixed;
            top: -100px;
            left: 0;
            width: 100%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 0;
            z-index: 1030;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transition: top 0.4s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .sticky-header.visible {
            top: 0;
        }
        
        .sticky-header .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        
        .sticky-header .nav-links {
            display: flex;
            margin-left: 20px;
        }
        
        .sticky-header .nav-links a {
            color: white;
            text-decoration: none;
            margin-left: 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .sticky-header .nav-links a:after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: var(--accent-color);
            transition: width 0.3s ease;
        }
        
        .sticky-header .nav-links a:hover:after {
            width: 100%;
        }
        
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--accent-color), var(--secondary-color));
            z-index: 1031;
            transition: width 0.1s ease;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1020;
        }
        
        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }
        
        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.3);
        }
        
        .hero-section {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 4rem 0;
            text-align: center;
            transition: padding 0.4s ease-in-out;
        }
        
        .hero-section h1 {
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .hero-section p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .section-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .section-title {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
        }
        
        .section-title i {
            margin-right: 10px;
            color: var(--accent-color);
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid #ddd;
            padding: 12px;
            transition: all 0.3s ease;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.25rem rgba(41, 128, 185, 0.25);
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            border-radius: 8px;
            padding: 10px 20px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .btn-primary:disabled {
            background-color: #6c757d;
            border-color: #6c757d;
            transform: none;
            cursor: not-allowed;
        }
        
        .search-results {
            margin-top: 2rem;
        }
        
        .search-results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .search-results-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
        }
        
        .search-results-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .search-sort-select {
            border-radius: 20px;
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            font-size: 0.9rem;
        }
        
        .clear-search-btn {
            background: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            color: #666;
            transition: all 0.3s ease;
        }
        
        .clear-search-btn:hover {
            background: #e9ecef;
            color: #333;
        }
        
        .result-item {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border-left: 4px solid var(--accent-color);
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        
        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        
        .result-item.claimed {
            border-left-color: var(--success-color);
        }
        
        .result-item.recovered {
            border-left-color: var(--info-color);
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary-color);
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        .result-title i {
            margin-right: 8px;
            color: var(--accent-color);
        }
        
        .result-badge {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .badge-lost {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--danger-color);
        }
        
        .badge-found {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--success-color);
        }
        
        .badge-recovered {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--info-color);
        }
        
        .badge-claimed {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--success-color);
        }
        
        .result-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        .result-meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .result-meta-item i {
            color: var(--secondary-color);
        }
        
        .result-description {
            margin-bottom: 1rem;
            color: #555;
            line-height: 1.5;
        }
        
        .result-contact {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .result-contact a {
            color: var(--secondary-color);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            transition: color 0.3s ease;
        }
        
        .result-contact a:hover {
            color: var(--primary-color);
        }
        
        .result-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }
        
        .result-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            font-weight: 500;
        }
        
        .status-success {
            color: var(--success-color);
        }
        
        .status-info {
            color: var(--info-color);
        }
        
        .result-buttons {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-result {
            border-radius: 20px;
            padding: 0.4rem 1rem;
            font-size: 0.85rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }
        
        .btn-claim {
            background-color: rgba(46, 204, 113, 0.1);
            color: var(--success-color);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }
        
        .btn-claim:hover {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-recover {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--info-color);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }
        
        .btn-recover:hover {
            background-color: var(--info-color);
            color: white;
        }
        
        .no-results {
            text-align: center;
            padding: 3rem 2rem;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 2rem 0;
        }
        
        .no-results-icon {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 1rem;
        }
        
        .no-results-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #666;
            margin-bottom: 1rem;
        }
        
        .no-results-text {
            color: #888;
            margin-bottom: 1.5rem;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .no-results-suggestions {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            text-align: left;
            border-left: 4px solid var(--accent-color);
        }
        
        .no-results-suggestions h6 {
            color: var(--primary-color);
            margin-bottom: 0.75rem;
        }
        
        .no-results-suggestions ul {
            margin-bottom: 0;
            padding-left: 1.5rem;
        }
        
        .no-results-suggestions li {
            margin-bottom: 0.5rem;
            color: #666;
        }
        
        .no-results-suggestions li:last-child {
            margin-bottom: 0;
        }
        
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem 0;
        }
        
        .loading-spinner.active {
            display: block;
        }
        
        .spinner-container {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
        }
        
        .spinner-container div {
            position: absolute;
            top: 33px;
            width: 13px;
            height: 13px;
            border-radius: 50%;
            background: var(--secondary-color);
            animation-timing-function: cubic-bezier(0, 1, 1, 0);
        }
        
        .spinner-container div:nth-child(1) {
            left: 8px;
            animation: lds-ellipsis1 0.6s infinite;
        }
        
        .spinner-container div:nth-child(2) {
            left: 8px;
            animation: lds-ellipsis2 0.6s infinite;
        }
        
        .spinner-container div:nth-child(3) {
            left: 32px;
            animation: lds-ellipsis2 0.6s infinite;
        }
        
        .spinner-container div:nth-child(4) {
            left: 56px;
            animation: lds-ellipsis3 0.6s infinite;
        }
        
        @keyframes lds-ellipsis1 {
            0% {
                transform: scale(0);
            }
            100% {
                transform: scale(1);
            }
        }
        
        @keyframes lds-ellipsis3 {
            0% {
                transform: scale(1);
            }
            100% {
                transform: scale(0);
            }
        }
        
        @keyframes lds-ellipsis2 {
            0% {
                transform: translate(0, 0);
            }
            100% {
                transform: translate(24px, 0);
            }
        }
        
        .loading-text {
            margin-top: 1rem;
            color: #666;
            font-size: 1.1rem;
        }
        
        .footer {
            background-color: var(--primary-color);
            color: white;
            padding: 2rem 0;
            margin-top: 4rem;
            text-align: center;
        }
        
        .footer a {
            color: var(--accent-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer a:hover {
            color: white;
            text-decoration: underline;
        }
        
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }
        
        .toast {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            animation: slideInRight 0.4s ease;
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .toast-success {
            border-left: 4px solid #2ecc71;
        }
        
        .toast-error {
            border-left: 4px solid #e74c3c;
        }
        
        .toast-body {
            position: relative;
        }
        
        .platform-icons {
            margin-top: 1rem;
        }
        
        .platform-icons a {
            color: white;
            font-size: 1.5rem;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .platform-icons a:hover {
            transform: scale(1.2);
            color: var(--accent-color);
        }
        
        .whatsapp-note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 10px 15px;
            margin-bottom: 15px;
            border-radius: 4px;
        }
        
        .safety-tips {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .safety-tips h5 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .safety-tips ul {
            margin-bottom: 0;
            padding-left: 20px;
        }
        
        .safety-tips li {
            margin-bottom: 8px;
            color: #856404;
        }
        
        .safety-tips li:last-child {
            margin-bottom: 0;
        }
        
        .safety-tips i {
            color: #ffc107;
            margin-right: 8px;
        }
        
        .section-break {
            height: 2px;
            background: linear-gradient(to right, transparent, #ddd, transparent);
            margin: 3rem 0;
        }
        
        .supporters-section {
            background: var(--supporter-gradient);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 1rem;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        .supporters-section::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: pulse 4s ease-in-out infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.5; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(0.8); opacity: 0.5; }
        }
        
        .supporters-header {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }
        
        .supporters-counter {
            font-size: 3rem;
            font-weight: bold;
            margin: 1rem 0;
            display: inline-block;
            min-width: 80px;
        }
        
        .supporters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.2rem;
            margin-top: 2rem;
        }
        
        .supporter-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            z-index: 1;
        }
        
        .supporter-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .supporter-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            display: block;
        }
        
        .supporter-info {
            padding: 1rem;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
        }
        
        .supporter-avatar {
            display: none; /* Hide the avatar since we're using background images */
        }
        
        .supporter-name {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: white;
        }
        
        .supporter-role {
            font-size: 0.75rem;
            opacity: 0.9;
            margin-bottom: 0.3rem;
            color: white;
        }
        
        .supporter-department {
            font-size: 0.7rem;
            opacity: 0.8;
            font-style: italic;
            color: white;
        }
        
        .toggle-supporters-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }
        
        .toggle-supporters-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .collapse {
            transition: max-height 0.5s ease;
        }
        
        .supporter-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background: var(--accent-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            z-index: 2;
        }
        
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
        }
        
        .particle {
            position: absolute;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            pointer-events: none;
        }
        
        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }
        
        .matching-item-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--accent-color);
        }
        
        .matching-item-card h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        .matching-item-card .detail-row {
            display: flex;
            margin-bottom: 0.75rem;
        }
        
        .matching-item-card .detail-label {
            font-weight: 600;
            width: 120px;
            color: #555;
        }
        
        .matching-item-card .detail-value {
            flex: 1;
        }
        
        .matching-item-card .contact-btn {
            margin-top: 1rem;
            display: inline-block;
            background-color: #25D366;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .matching-item-card .contact-btn:hover {
            background-color: #128C7E;
            color: white;
        }
        
        .modal-content {
            border-radius: 15px;
            border: none;
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 15px 15px 0 0;
            border: none;
        }
        
        .modal-title {
            font-weight: 600;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .founder-details {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .founder-details h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }
        
        .founder-details .detail-row {
            display: flex;
            margin-bottom: 0.75rem;
        }
        
        .founder-details .detail-label {
            font-weight: 600;
            width: 120px;
            color: #555;
        }
        
        .founder-details .detail-value {
            flex: 1;
        }
        
        .founder-details .contact-btn {
            margin-top: 1rem;
            display: inline-block;
            background-color: #25D366;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 500;
            transition: background-color 0.3s;
        }
        
        .founder-details .contact-btn:hover {
            background-color: #128C7E;
            color: white;
        }
        
        .found-item-actions {
            margin-top: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .claimed-status {
            background-color: #28a745;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .report-details-modal .modal-dialog {
            max-width: 600px;
        }
        
        .report-details-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .report-details-card h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.3rem;
        }
        
        .report-details-card .detail-row {
            display: flex;
            margin-bottom: 1rem;
        }
        
        .report-details-card .detail-label {
            font-weight: 600;
            width: 140px;
            color: #555;
        }
        
        .report-details-card .detail-value {
            flex: 1;
        }
        
        .verification-code-box {
            background-color: #e9ecef;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            letter-spacing: 2px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .verification-code-box:hover {
            background-color: #dee2e6;
            transform: scale(1.02);
        }
        
        .toast-action-btn {
            margin-top: 10px;
        }
        
        .safety-alert {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .safety-alert h6 {
            color: #721c24;
            margin-bottom: 10px;
        }
        
        .safety-alert p {
            color: #721c24;
            margin-bottom: 0;
        }
        
        .verification-input-group {
            margin: 1.5rem 0;
        }
        
        .verification-input {
            text-align: center;
            font-weight: bold;
            font-size: 1.2rem;
            letter-spacing: 3px;
        }
        
        .forgot-code-tip {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 10px;
            text-align: center;
            font-style: italic;
        }
        
        .guide-section {
            background-color: #e7f3ff;
            border-left: 4px solid #0066cc;
            padding: 15px;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .guide-section h6 {
            color: #004c99;
            margin-bottom: 10px;
        }
        
        .guide-section ol {
            color: #004c99;
            padding-left: 20px;
        }
        
        .guide-section li {
            margin-bottom: 8px;
        }
        
        .guide-section li:last-child {
            margin-bottom: 0;
        }
        
        .importance-note {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-top: 1rem;
        }
        
        .importance-note h6 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .importance-note p {
            color: #856404;
            margin-bottom: 0;
        }
        
        .mark-as-recovered-btn {
            background-color: #17a2b8;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .mark-as-recovered-btn:hover {
            background-color: #138496;
            color: white;
        }
        
        .modal-backdrop {
            background-color: rgba(0, 0, 0, 0.5);
        }
        
        .verification-modal-title {
            font-size: 1.25rem;
            font-weight: 600;
        }
        
        .modal-icon {
            font-size: 3rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .lost-verification-modal .modal-body {
            text-align: center;
        }
        
        .copy-tooltip {
            position: absolute;
            background-color: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .copy-tooltip.show {
            opacity: 1;
        }
        
        .verification-error {
            display: none;
            background-color: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid #dc3545;
        }
        
        .verification-error.show {
            display: block;
        }
        
        .verification-error i {
            margin-right: 8px;
        }
        
        .image-upload-container {
            margin-bottom: 1rem;
        }
        
        .image-upload-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .image-upload-input {
            display: none;
        }
        
        .image-upload-preview {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            background-color: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
            overflow: hidden;
            position: relative;
        }
        
        .image-upload-preview:hover {
            border-color: var(--secondary-color);
            background-color: #f0f8ff;
        }
        
        .image-upload-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .image-upload-placeholder {
            text-align: center;
            color: #6c757d;
        }
        
        .image-upload-placeholder i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #adb5bd;
        }
        
        .image-upload-text {
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .image-upload-subtext {
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .image-upload-progress {
            display: none;
            margin-top: 10px;
        }
        
        .image-upload-progress.show {
            display: block;
        }
        
        .progress {
            height: 10px;
            border-radius: 5px;
            background-color: #e9ecef;
        }
        
        .progress-bar {
            background-color: var(--secondary-color);
            border-radius: 5px;
        }
        
        .upload-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 5px;
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .upload-percentage {
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        /* Increased thumbnail size for images in search results */
        .result-image {
            width: 120px;  /* Increased from 80px */
            height: 120px; /* Increased from 80px */
            border-radius: 8px;
            object-fit: cover;
            margin-right: 1rem;
            border: 1px solid #eee;
        }
        
        .result-content {
            flex: 1;
        }
        
        .result-header-with-image {
            display: flex;
            align-items: flex-start;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 768px) {
            .sticky-header .nav-links {
                display: none;
            }
            
            .sticky-header .logo {
                font-size: 1.2rem;
            }
            
            .result-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .result-actions {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }
            
            .result-buttons {
                width: 100%;
                justify-content: flex-end;
            }
            
            .result-header-with-image {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .result-image {
                margin-right: 0;
                margin-bottom: 1rem;
            }
            
            .supporters-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <!-- Scroll Progress Indicator -->
    <div class="scroll-progress" id="scrollProgress"></div>
    
    <!-- Sticky Header -->
    <header class="sticky-header" id="stickyHeader">
        <div class="logo">
            <span>FINDITKWASU.NG</span>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero-section" id="hero">
        <div class="container">
            <h1>KWASU Lost & Found Portal</h1>
            <p>Report lost items, found items, or search for your belongings across all platforms</p>
            <div class="platform-icons">
                <a href="https://t.me/KwasuLostFound_Bot" target="_blank" title="Telegram Bot"><i class="bi bi-telegram"></i></a>
                <a href="https://wa.link/9765zr" target="_blank" title="WhatsApp Bot"><i class="bi bi-whatsapp"></i></a>
            </div>
        </div>
    </section>

    <div class="container my-5">
        <div class="row">
            <!-- Report Lost Item Section -->
            <div class="col-lg-6 mb-4" id="report-lost">
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="bi bi-search"></i> Report Lost Item
                    </h3>
                    <div class="whatsapp-note">
                        <i class="bi bi-whatsapp"></i> <strong>Important:</strong> Please provide your WhatsApp number for faster communication.
                    </div>
                    <form id="lost-item-form">
                        <div class="mb-3">
                            <label for="lost-item" class="form-label">Item Name</label>
                            <input type="text" class="form-control" id="lost-item" placeholder="e.g., ID Card, Bag, Phone, Wallet" required>
                        </div>
                        <div class="mb-3">
                            <label for="lost-location" class="form-label">Location</label>
                            <input type="text" class="form-control" id="lost-location" placeholder="e.g., E-Library, Auditorium, School Gate" required>
                        </div>
                        <div class="mb-3">
                            <label for="lost-last-seen" class="form-label">Last Seen Location (if known)</label>
                            <input type="text" class="form-control" id="lost-last-seen" placeholder="e.g., Near the library entrance, Cafeteria table 5">
                        </div>
                        <div class="mb-3">
                            <label for="lost-description" class="form-label">Description of the lost Item</label>
                            <textarea class="form-control" id="lost-description" rows="3" placeholder="Provide details about your item (color, brand, unique features, etc.)" required></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="lost-contact" class="form-label">Your WhatsApp Number</label>
                            <input type="tel" class="form-control" id="lost-contact" placeholder="e.g., 08012345678" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Report Lost Item</button>
                    </form>
                </div>
            </div>

            <!-- Report Found Item Section -->
            <div class="col-lg-6 mb-4" id="report-found">
                <div class="section-card">
                    <h3 class="section-title">
                        <i class="bi bi-gift"></i> Report Found Item
                    </h3>
                    <div class="whatsapp-note">
                        <i class="bi bi-whatsapp"></i> <strong>Important:</strong> Please provide your WhatsApp number for faster communication.
                    </div>
                    <form id="found-item-form">
                        <div class="mb-3">
                            <label for="found-item" class="form-label">Item Name</label>
                            <input type="text" class="form-control" id="found-item" placeholder="e.g., Key, Wristwatch, ID Card, Phone" required>
                        </div>
                        <div class="mb-3">
                            <label for="found-location" class="form-label">Location</label>
                            <input type="text" class="form-control" id="found-location" placeholder="e.g., Infront of ICT, School Clinic, Main Library" required>
                        </div>
                        <div class="mb-3">
                            <label for="found-description" class="form-label">Description of the Found Item</label>
                            <textarea class="form-control" id="found-description" rows="3" placeholder="Provide details about the found item (color, brand, unique features, etc.)"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="found-contact" class="form-label">Your WhatsApp Number</label>
                            <input type="tel" class="form-control" id="found-contact" placeholder="e.g., 08012345678" required>
                        </div>
                        <div class="image-upload-container">
                            <label class="image-upload-label">Item Image <span class="text-danger">*</span></label>
                            <input type="file" class="image-upload-input" id="found-image" accept="image/*" required>
                            <div class="image-upload-preview" id="image-preview">
                                <div class="image-upload-placeholder">
                                    <i class="bi bi-camera"></i>
                                    <div class="image-upload-text">Click to upload image</div>
                                    <div class="image-upload-subtext">JPG, PNG or GIF (max. 5MB)</div>
                                </div>
                            </div>
                            <div class="image-upload-progress" id="image-upload-progress">
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                </div>
                                <div class="upload-status">
                                    <span>Processing image...</span>
                                    <span class="upload-percentage">0%</span>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary w-100" id="found-item-submit-btn" disabled>Report Found Item</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Search Section -->
        <div class="section-card" id="search-items">
            <h3 class="section-title">
                <i class="bi bi-search"></i> Search for Items
            </h3>
            <div class="row">
                <div class="col-md-8">
                    <div class="input-group">
                        <input type="text" class="form-control" id="search-input" placeholder="Enter keywords (e.g., water, keys, bag)">
                        <button class="btn btn-primary" type="button" id="search-btn">Search</button>
                    </div>
                </div>
                <div class="col-md-4">
                    <select class="form-select" id="filter-type">
                        <option value="all">All Items</option>
                        <option value="lost">Lost Items Only</option>
                        <option value="found">Found Items Only</option>
                    </select>
                </div>
            </div>
            
            <div class="loading-spinner" id="search-loading">
                <div class="spinner-container">
                    <div></div>
                    <div></div>
                    <div></div>
                    <div></div>
                </div>
                <p class="loading-text">Searching for items...</p>
            </div>
            
            <div class="search-results" id="search-results"></div>
        </div>

        <!-- Safety Tips Section -->
        <div class="section-card" id="safety-tips">
            <h3 class="section-title">
                <i class="bi bi-shield-check"></i> Safety Tips
            </h3>
            <div class="alert alert-warning">
                <i class="bi bi-exclamation-triangle-fill"></i> <strong>Important:</strong> These safety guidelines are for personal safety and to prevent scams. Please follow them carefully.
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="safety-tips">
                        <h5><i class="bi bi-person-x"></i> For Lost Item Reporters</h5>
                        <ul>
                            <li>When someone contacts you claiming to have found your item, ask for specific details to verify ownership</li>
                            <li>Never share personal information beyond what is necessary</li>
                            <li>Meet in a safe, public place on campus to retrieve your item</li>
                            <li>If you suspect a scam, report the person's number to KWASU Safety Unit or contact the developer</li>
                        </ul>
                    </div>
                </div>
                
                <div class="col-md-6">
                    <div class="safety-tips">
                        <h5><i class="bi bi-person-check"></i> For Found Item Reporters</h5>
                        <ul>
                            <li>When someone claims an item, ask for evidence of ownership (specific details, photos, etc.)</li>
                            <li>Do not return the item until you are confident about the claimant's identity</li>
                            <li>If you notice a false claim, report the person's number to KWASU Safety Unit immediately</li>
                            <li>You can also contact the developer for assistance in reporting false claimants</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <div class="mt-3 p-3 bg-light rounded">
                <h6 class="text-center"><i class="bi bi-info-circle"></i> How to Report Suspicious Activity</h6>
                <p class="mb-0 text-center">
                    <strong>KWASU Safety Unit:</strong> Contact campus security | 
                    <strong>Developer:</strong> <a href="tel:09038323588">Rugged</a>
                </p>
            </div>
        </div>

        <!-- Simple Section Break -->
        <div class="section-break"></div>

        <!-- Top Supporters Section -->
        <div class="section-card">
            <h3 class="section-title">
                <i class="bi bi-people"></i> Top Supporters
            </h3>
            <p>We extend our heartfelt gratitude to the following individuals who supported this project:</p>
            
            <div class="supporters-section">
                <div class="particles" id="particles"></div>
                
                <div class="supporters-header">
                    <p>Meet our amazing supporters</p>
                    <div class="supporters-counter" id="supporters-counter">0</div>
                    <p>Incredible Contributors</p>
                    
                    <button class="btn toggle-supporters-btn" type="button" data-bs-toggle="collapse" data-bs-target="#supporters-list" aria-expanded="false" aria-controls="supporters-list">
                        <i class="bi bi-chevron-down"></i> <span id="toggle-text">View Supporters</span>
                    </button>
                </div>
                
                <div class="collapse mt-4" id="supporters-list">
                    <div class="supporters-grid">
                        <div class="supporter-card">
                            <div class="supporter-badge">1</div>
                            <img src="https://i.imghippo.com/files/Ixm6386PoI.jpg" alt="RAJI ABDULSAMAD" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">RAJI ABDULSAMAD (PEOPLE)</div>
                                <div class="supporter-role">SU President</div>
                                <div class="supporter-department">(English Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">2</div>
                            <img src="https://i.imghippo.com/files/fju5384dB.jpg" alt="AREMU FERANMI JOSEPH" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">AREMU FERANMI JOSEPH</div>
                                <div class="supporter-role">SU General Secretary</div>
                                <div class="supporter-department">(Civil and Environmental Engineering Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">3</div>
                            <img src="https://i.imghippo.com/files/GAbW4648QB.jpg" alt="VICTOR OLAYINKA OTITODUN" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">VICTOR OLAYINKA OTITODUN</div>
                                <div class="supporter-role">SU Public Relations Officer</div>
                                <div class="supporter-department">(Animal Production Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">4</div>
                            <img src="https://i.imghippo.com/files/MDiT1250UU.jpg" alt="ABDULAZEEZ USMAN ISIAQ" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">ABDULAZEEZ USMAN ISIAQ</div>
                                <div class="supporter-role">SU Welfare Director</div>
                                <div class="supporter-department">(Biochemistry Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">5</div>
                            <img src="https://i.imghippo.com/files/hJWH7439SIE.jpg" alt="KEWULERE MUSTAPHA ADETAYO" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">KEWULERE MUSTAPHA ADETAYO</div>
                                <div class="supporter-role">SU Welfare Director 2</div>
                                <div class="supporter-department">(Politics and Governance Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">6</div>
                            <img src="https://i.imghippo.com/files/fHS5522IkY.jpg" alt="Full Name Six" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">MUHAMMAD ABDULKABIR</div>
                                <div class="supporter-role">Premium Product Reviewer</div>
                                <div class="supporter-department">(Graduate🎓)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">7</div>
                            <img src="https://i.imghippo.com/files/KrVs8167Bzk.jpg" alt="Full Name Seven" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">SOFIULLAHI KAMALDEEN (Kasco)</div>
                                <div class="supporter-role">Product Designer</div>
                                <div class="supporter-department">(Computer Science Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">8</div>
                            <img src="https://picsum.photos/seed/supporter8/400/300.jpg" alt="Full Name Eight" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">Full Name Eight</div>
                                <div class="supporter-role">Documentation</div>
                                <div class="supporter-department">(Library Science Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">9</div>
                            <img src="https://picsum.photos/seed/supporter9/400/300.jpg" alt="Full Name Nine" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">Full Name Nine</div>
                                <div class="supporter-role">Feedback Provider</div>
                                <div class="supporter-department">(Psychology Dpt.)</div>
                            </div>
                        </div>
                        
                        <div class="supporter-card">
                            <div class="supporter-badge">10</div>
                            <img src="https://picsum.photos/seed/supporter10/400/300.jpg" alt="Full Name Ten" class="supporter-image">
                            <div class="supporter-info">
                                <div class="supporter-name">Full Name Ten</div>
                                <div class="supporter-role">Evangelist</div>
                                <div class="supporter-department">(Political Science Dpt.)</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 KWASU Lost & Found Portal.<br>Endorsed by Students' Union (People's Era).<br>Designed & Developed by Rugged of ICT.</p>
            <p>For support: <a href="tel:09038323588">09038323588</a></p>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <div class="back-to-top" id="backToTop">
        <i class="bi bi-arrow-up"></i>
    </div>

    <!-- Toast Container -->
    <div class="toast-container"></div>

    <!-- Report Details Modal -->
    <div class="modal fade report-details-modal" id="reportDetailsModal" tabindex="-1" aria-labelledby="reportDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reportDetailsModalLabel">Report Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="reportDetailsContent">
                        <!-- Report details will be inserted here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Copy Tooltip -->
    <div class="copy-tooltip" id="copyTooltip">Copied to clipboard!</div>

    <!-- Matching Items Modal -->
    <div class="modal fade" id="matchingItemsModal" tabindex="-1" aria-labelledby="matchingItemsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="matchingItemsModalLabel">Matching Found Items</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="matchingItemsContent">
                        <!-- Matching items will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Verification Modal for Found Items -->
    <div class="modal fade" id="verificationModal" tabindex="-1" aria-labelledby="verificationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="verificationModalLabel">Verify Item Claim</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>To verify that you are the original reporter of this found item, please enter the verification code that was sent to your WhatsApp number when you first reported the item.</p>
                    
                    <div class="verification-error" id="verification-error">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        <span>Invalid verification code. Please try again.</span>
                    </div>
                    
                    <div class="verification-input-group">
                        <label for="verification-code-input" class="form-label">Enter Verification Code:</label>
                        <input type="text" class="form-control verification-input" id="verification-code-input" placeholder="Enter your 6-character code" maxlength="6">
                    </div>
                    
                    <p class="forgot-code-tip">
                        <i class="bi bi-info-circle"></i> If you forgot your verification code, please contact the developer at <a href="tel:09038323588">09038323588</a>
                    </p>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="button" class="btn btn-primary" id="confirmClaimBtn">Confirm and Mark as Claimed</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Verification Modal for Lost Items -->
    <div class="modal fade lost-verification-modal" id="lostVerificationModal" tabindex="-1" aria-labelledby="lostVerificationModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="lostVerificationModalLabel">Verify Item Recovery</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body lost-verification-modal">
                    <div class="modal-icon">
                        <i class="bi bi-shield-check"></i>
                    </div>
                    <p>To verify that you are the original reporter of this lost item, please enter the verification code that was generated when you first reported the item.</p>
                    
                    <div class="verification-error" id="lost-verification-error">
                        <i class="bi bi-exclamation-triangle-fill"></i>
                        <span>Invalid verification code. Please try again.</span>
                    </div>
                    
                    <div class="verification-input-group">
                        <label for="lost-verification-code-input" class="form-label">Enter Verification Code:</label>
                        <input type="text" class="form-control verification-input" id="lost-verification-code-input" placeholder="Enter your 6-character code" maxlength="6">
                    </div>
                    
                    <p class="forgot-code-tip">
                        <i class="bi bi-info-circle"></i> If you forgot your verification code, please contact the developer at <a href="tel:09038323588">09038323588</a>
                    </p>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="button" class="btn btn-primary" id="confirmRecoveredBtn">Confirm and Mark as Recovered</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Founder Details Modal -->
    <div class="modal fade" id="founderDetailsModal" tabindex="-1" aria-labelledby="founderDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="founderDetailsModalLabel">Founder Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="founderDetailsContent">
                        <!-- Founder details will be inserted here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-database-compat.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script>
        // Initialize Firebase
        const firebaseConfig = {
            databaseURL: "https://kwasu-lost-and-found-default-rtdb.firebaseio.com/"
        };
        
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        
        // DOM Elements
        const lostItemForm = document.getElementById('lost-item-form');
        const foundItemForm = document.getElementById('found-item-form');
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const filterType = document.getElementById('filter-type');
        const searchResults = document.getElementById('search-results');
        const searchLoading = document.getElementById('search-loading');
        const toastContainer = document.querySelector('.toast-container');
        const toggleText = document.getElementById('toggle-text');
        const supportersList = document.getElementById('supporters-list');
        const supportersCounter = document.getElementById('supporters-counter');
        const particles = document.getElementById('particles');
        const matchingItemsModal = new bootstrap.Modal(document.getElementById('matchingItemsModal'));
        const matchingItemsContent = document.getElementById('matchingItemsContent');
        const verificationModal = new bootstrap.Modal(document.getElementById('verificationModal'));
        const verificationCodeInput = document.getElementById('verification-code-input');
        const verificationError = document.getElementById('verification-error');
        const confirmClaimBtn = document.getElementById('confirmClaimBtn');
        const lostVerificationModal = new bootstrap.Modal(document.getElementById('lostVerificationModal'));
        const lostVerificationCodeInput = document.getElementById('lost-verification-code-input');
        const lostVerificationError = document.getElementById('lost-verification-error');
        const confirmRecoveredBtn = document.getElementById('confirmRecoveredBtn');
        const founderDetailsModal = new bootstrap.Modal(document.getElementById('founderDetailsModal'));
        const founderDetailsContent = document.getElementById('founderDetailsContent');
        const reportDetailsModal = new bootstrap.Modal(document.getElementById('reportDetailsModal'));
        const reportDetailsContent = document.getElementById('reportDetailsContent');
        const copyTooltip = document.getElementById('copyTooltip');
        const foundImageInput = document.getElementById('found-image');
        const imagePreview = document.getElementById('image-preview');
        const imageUploadProgress = document.getElementById('image-upload-progress');
        const progressBar = document.querySelector('.progress-bar');
        const uploadPercentage = document.querySelector('.upload-percentage');
        const foundItemSubmitBtn = document.getElementById('found-item-submit-btn');
        
        // Sticky header and scroll elements
        const stickyHeader = document.getElementById('stickyHeader');
        const scrollProgress = document.getElementById('scrollProgress');
        const backToTop = document.getElementById('backToTop');
        const heroSection = document.getElementById('hero');
        
        // Global variables
        let currentItemToClaim = null;
        let currentItemToRecover = null;
        let matchingFoundItems = [];
        let lastReportData = null;
        let lastScrollTop = 0;
        let currentSearchTerm = '';
        let selectedImageFile = null;
        let uploadedImageUrl = null;
        let isImageProcessed = false;
        
        // Create floating particles
        function createParticles() {
            const particleCount = 20;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const size = Math.random() * 5 + 2;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particle.style.animationDelay = Math.random() * 10 + 's';
                particle.style.animation = 'float linear infinite';
                
                particles.appendChild(particle);
            }
        }
        
        // Generate random verification code
        function generateVerificationCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }
        
        // Animate counter
        function animateCounter(target, duration = 2000) {
            let start = 0;
            const increment = target / (duration / 16);
            
            const timer = setInterval(() => {
                start += increment;
                if (start >= target) {
                    supportersCounter.textContent = target;
                    clearInterval(timer);
                } else {
                    supportersCounter.textContent = Math.floor(start);
                }
            }, 16);
        }
        
        // Toggle Supporters List
        supportersList.addEventListener('show.bs.collapse', function () {
            toggleText.textContent = 'Hide Supporters';
            animateCounter(10);
        });
        
        supportersList.addEventListener('hide.bs.collapse', function () {
            toggleText.textContent = 'View Supporters';
            supportersCounter.textContent = '0';
        });
        
        // Show toast notification with action button
        function showToast(message, type = 'success', actionButton = null) {
            const toastId = 'toast-' + Date.now();
            const toastHtml = `
                <div id="${toastId}" class="toast toast-${type}" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                        <i class="bi bi-${type === 'success' ? 'check-circle-fill text-success' : 'exclamation-triangle-fill text-danger'} me-2"></i>
                        <strong class="me-auto">KWASU Lost & Found</strong>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">
                        ${message}
                        ${actionButton ? `<button type="button" class="btn btn-sm btn-primary mt-2 toast-action-btn">${actionButton.text}</button>` : ''}
                    </div>
                </div>
            `;
            
            toastContainer.insertAdjacentHTML('beforeend', toastHtml);
            const toastElement = document.getElementById(toastId);
            const toast = new bootstrap.Toast(toastElement, { autohide: true, delay: 10000 }); // Auto-hide after 10 seconds
            toast.show();
            
            // Add click event if action button is provided
            if (actionButton) {
                const actionBtn = toastElement.querySelector('.toast-action-btn');
                actionBtn.addEventListener('click', () => {
                    actionButton.callback();
                    toast.hide();
                });
            }
            
            toastElement.addEventListener('hidden.bs.toast', () => {
                toastElement.remove();
            });
            
            return toastId;
        }
        
        // Show report details modal (Original version with all tips)
        function showReportDetailsModal(reportData) {
            let html = '';
            
            if (reportData.type === 'lost') {
                html = `
                    <div class="report-details-card">
                        <h5><i class="bi bi-search"></i> Lost Item Details</h5>
                        <div class="detail-row">
                            <div class="detail-label">Item Name:</div>
                            <div class="detail-value">${reportData.item}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Location:</div>
                            <div class="detail-value">${reportData.location}</div>
                        </div>
                        ${reportData.last_seen ? `
                        <div class="detail-row">
                            <div class="detail-label">Last Seen:</div>
                            <div class="detail-value">${reportData.last_seen}</div>
                        </div>
                        ` : ''}
                        <div class="detail-row">
                            <div class="detail-label">Description:</div>
                            <div class="detail-value">${reportData.description}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Contact:</div>
                            <div class="detail-value">${reportData.contact_info}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Verification Code:</div>
                            <div class="detail-value">
                                <div class="verification-code-box" id="lostReportVerificationCode">
                                    ${reportData.verification_code}
                                </div>
                                <small class="text-muted">Click to copy</small>
                            </div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Reported On:</div>
                            <div class="detail-value">${new Date(reportData.timestamp).toLocaleString()}</div>
                        </div>
                        
                        <div class="importance-note">
                            <h6><i class="bi bi-exclamation-triangle-fill"></i> Why You Need to Save This Code</h6>
                            <p>This verification code is your proof that you reported this lost item. You will need it to:</p>
                            <ul>
                                <li>Verify your identity when marking the item as recovered</li>
                                <li>Prevent unauthorized users from marking your item as recovered</li>
                                <li>Ensure the security and integrity of your report</li>
                            </ul>
                            <p class="mb-0"><strong>Please save this code by taking a screenshot or writing it down!</strong></p>
                        </div>
                        
                        <div class="guide-section">
                            <h6><i class="bi bi-list-ol"></i> How to Mark Your Item as Recovered</h6>
                            <p>After you've recovered your lost item, please follow these steps to mark it as recovered:</p>
                            <ol>
                                <li>Return to this website (KWASU Lost & Found Portal)</li>
                                <li>Scroll down to the search section</li>
                                <li>Search for the item you reported using keywords</li>
                                <li>Find your reported item in the search results</li>
                                <li>Click the "Mark as Recovered" button</li>
                                <li>Enter your verification code when prompted</li>
                                <li>Confirm to mark the item as recovered</li>
                            </ol>
                            
                            <h6 class="mt-3"><i class="bi bi-heart-fill text-danger"></i> Why This Is Important</h6>
                            <p>Marking items as recovered helps keep our database clean and prevents confusion for other users. It also helps us track the success of this portal in reuniting lost items with their owners.</p>
                        </div>
                        
                        <div class="safety-alert">
                            <h6><i class="bi bi-shield-exclamation"></i> Safety Tips for Lost Item Reporters</h6>
                            <p>When someone contacts you claiming to have found your item:</p>
                            <ul>
                                <li>Ask for specific details about the item to verify ownership</li>
                                <li>Never share personal information beyond what is necessary</li>
                                <li>Meet in a safe, public place on campus to retrieve your item</li>
                                <li>If you suspect a scam, report the person's number to KWASU Safety Unit or contact the developer at 09038323588</li>
                            </ul>
                        </div>
                    </div>
                `;
            } else if (reportData.type === 'found') {
                html = `
                    <div class="report-details-card">
                        <h5><i class="bi bi-gift"></i> Found Item Details</h5>
                        <div class="detail-row">
                            <div class="detail-label">Item Name:</div>
                            <div class="detail-value">${reportData.item}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Location:</div>
                            <div class="detail-value">${reportData.location}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Contact:</div>
                            <div class="detail-value">${reportData.contact_phone}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Item Image:</div>
                            <div class="detail-value">
                                <img src="${reportData.image_url}" alt="${reportData.item}" style="max-width: 100%; max-height: 200px; border-radius: 8px;">
                            </div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Verification Code:</div>
                            <div class="detail-value">
                                <div class="verification-code-box" id="foundReportVerificationCode">
                                    ${reportData.verification_code}
                                </div>
                                <small class="text-muted">Click to copy</small>
                            </div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Reported On:</div>
                            <div class="detail-value">${new Date(reportData.timestamp).toLocaleString()}</div>
                        </div>
                        
                        <div class="importance-note">
                            <h6><i class="bi bi-exclamation-triangle-fill"></i> Why You Need to Save This Code</h6>
                            <p>This verification code is your proof that you reported this item. You will need it to:</p>
                            <ul>
                                <li>Verify your identity when someone claims this item</li>
                                <li>Mark the item as claimed after returning it to the owner</li>
                                <li>Prevent false claims and scams</li>
                            </ul>
                            <p class="mb-0"><strong>Please save this code by taking a screenshot or writing it down!</strong></p>
                        </div>
                        
                        <div class="guide-section">
                            <h6><i class="bi bi-list-ol"></i> How to Mark Item as Claimed After Returning to Owner</h6>
                            <p>After you've returned the item to its rightful owner, please follow these steps to mark it as claimed:</p>
                            <ol>
                                <li>Return to this website (KWASU Lost & Found Portal)</li>
                                <li>Scroll down to the search section</li>
                                <li>Search for the item you reported using keywords</li>
                                <li>Find your reported item in the search results</li>
                                <li>Click the "Mark as Claimed" button</li>
                                <li>Enter your verification code when prompted</li>
                                <li>Confirm to mark the item as claimed</li>
                            </ol>
                            
                            <h6 class="mt-3"><i class="bi bi-heart-fill text-danger"></i> Why This Is Important</h6>
                            <p>Marking items as claimed helps keep our database clean and prevents confusion for other users. It also helps us track the success of this portal in reuniting lost items with their owners.</p>
                        </div>
                        
                        <div class="safety-alert">
                            <h6><i class="bi bi-shield-exclamation"></i> Important Safety Information</h6>
                            <p>When someone claims this item:</p>
                            <ul>
                                <li>Ask for specific details about the item to verify ownership</li>
                                <li>Do not return the item until you are confident about the claimant's identity</li>
                                <li>If you notice a false claim, report the person's number to KWASU Safety Unit immediately</li>
                                <li>You can also contact the developer for assistance in reporting false claimants</li>
                            </ul>
                        </div>
                    </div>
                `;
            }
            
            reportDetailsContent.innerHTML = html;
            reportDetailsModal.show();
            
            // Add click event to verification code to copy to clipboard
            const codeElementId = reportData.type === 'lost' ? 'lostReportVerificationCode' : 'foundReportVerificationCode';
            const codeElement = document.getElementById(codeElementId);
            if (codeElement) {
                codeElement.addEventListener('click', (e) => {
                    const code = reportData.verification_code;
                    navigator.clipboard.writeText(code).then(() => {
                        // Show tooltip
                        copyTooltip.style.left = e.pageX + 'px';
                        copyTooltip.style.top = (e.pageY - 30) + 'px';
                        copyTooltip.classList.add('show');
                        
                        setTimeout(() => {
                            copyTooltip.classList.remove('show');
                        }, 2000);
                    }).catch(err => {
                        console.error('Could not copy text: ', err);
                        showToast('Failed to copy verification code.', 'error');
                    });
                });
            }
        }
        
        // Show matching items modal
        function showMatchingItemsModal(matchingItems) {
            let html = '';
            
            matchingItems.forEach((item, index) => {
                const date = new Date(item.timestamp).toLocaleString();
                html += `
                    <div class="matching-item-card">
                        <h5>Matching Item #${index + 1}</h5>
                        <div class="detail-row">
                            <div class="detail-label">Item Name:</div>
                            <div class="detail-value">${item.item}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Found At:</div>
                            <div class="detail-value">${item.location}</div>
                        </div>
                        ${item.image_url ? `
                        <div class="detail-row">
                            <div class="detail-label">Item Image:</div>
                            <div class="detail-value">
                                <img src="${item.image_url}" alt="${item.item}" style="max-width: 100%; max-height: 150px; border-radius: 8px;">
                            </div>
                        </div>
                        ` : ''}
                        <div class="detail-row">
                            <div class="detail-label">Reported On:</div>
                            <div class="detail-value">${date}</div>
                        </div>
                        <div class="detail-row">
                            <div class="detail-label">Contact:</div>
                            <div class="detail-value">
                                <a href="https://wa.me/${item.contact_phone.replace(/^0/, '234')}" target="_blank" class="contact-btn">
                                    <i class="bi bi-whatsapp"></i> WhatsApp: ${item.contact_phone}
                                </a>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            matchingItemsContent.innerHTML = html;
            matchingItemsModal.show();
        }
        
        // Image upload preview
        imagePreview.addEventListener('click', () => {
            foundImageInput.click();
        });
        
        foundImageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                // Check file size (5MB limit)
                if (file.size > 5 * 1024 * 1024) {
                    showToast('Image size must be less than 5MB', 'error');
                    foundImageInput.value = '';
                    resetImagePreview();
                    return;
                }
                
                // Check file type
                if (!file.type.match('image.*')) {
                    showToast('Please select an image file (JPG, PNG, or GIF)', 'error');
                    foundImageInput.value = '';
                    resetImagePreview();
                    return;
                }
                
                selectedImageFile = file;
                
                // Show preview
                const reader = new FileReader();
                reader.onload = (e) => {
                    imagePreview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                reader.readAsDataURL(file);
                
                // Process image immediately using base64 encoding
                processImage(file);
            }
        });
        
        function resetImagePreview() {
            imagePreview.innerHTML = `
                <div class="image-upload-placeholder">
                    <i class="bi bi-camera"></i>
                    <div class="image-upload-text">Click to upload image</div>
                    <div class="image-upload-subtext">JPG, PNG or GIF (max. 5MB)</div>
                </div>
            `;
            selectedImageFile = null;
            uploadedImageUrl = null;
            isImageProcessed = false;
            // Keep submit button disabled until image is processed
            foundItemSubmitBtn.disabled = true;
        }
        
        // Process image using base64 encoding (Alternative Solution 2)
        function processImage(file) {
            // Show progress bar
            imageUploadProgress.classList.add('show');
            progressBar.style.width = '0%';
            progressBar.setAttribute('aria-valuenow', 0);
            uploadPercentage.textContent = '0%';
            
            // Disable submit button during processing
            foundItemSubmitBtn.disabled = true;
            foundItemSubmitBtn.textContent = 'Processing Image...';
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
                // Simulate processing progress
                let progress = 0;
                const interval = setInterval(() => {
                    progress += 10;
                    progressBar.style.width = `${progress}%`;
                    progressBar.setAttribute('aria-valuenow', progress);
                    uploadPercentage.textContent = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(interval);
                        
                        // Store the base64 image data
                        uploadedImageUrl = e.target.result;
                        isImageProcessed = true;
                        
                        // Hide progress bar
                        imageUploadProgress.classList.remove('show');
                        
                        // Update button text to indicate ready state
                        foundItemSubmitBtn.textContent = 'Ready to Submit';
                        
                        // Wait 4 seconds before enabling the submit button
                        setTimeout(() => {
                            // Re-enable submit button after delay
                            foundItemSubmitBtn.disabled = false;
                            foundItemSubmitBtn.textContent = 'Report Found Item';
                        }, 4000);  /* Changed from 3000ms to 4000ms (4 seconds) */
                    }
                }, 100);
            };
            
            reader.onerror = function(error) {
                console.error('Error reading file:', error);
                showToast('Failed to process image. Please try again.', 'error');
                
                // Hide progress bar
                imageUploadProgress.classList.remove('show');
                
                // Re-enable submit button
                foundItemSubmitBtn.disabled = false;
                foundItemSubmitBtn.textContent = 'Report Found Item';
                
                // Reset image preview
                resetImagePreview();
            };
            
            // Read the file as a data URL (base64)
            reader.readAsDataURL(file);
        }
        
        // Report Lost Item
        lostItemForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const item = document.getElementById('lost-item').value;
            const location = document.getElementById('lost-location').value;
            const lastSeen = document.getElementById('lost-last-seen').value;
            const description = document.getElementById('lost-description').value;
            const contact = document.getElementById('lost-contact').value;
            
            try {
                // Generate verification code
                const verificationCode = generateVerificationCode();
                
                const newReportRef = database.ref('reports').push();
                const reportData = {
                    type: 'lost',
                    item: item, // Keep original formatting
                    location: location, // Keep original formatting
                    last_seen: lastSeen, // Keep original formatting
                    description: description, // Keep original formatting
                    contact_info: contact,
                    verification_code: verificationCode,
                    recovered: false,
                    reporter: 'website',
                    timestamp: new Date().toISOString()
                };
                
                await newReportRef.set(reportData);
                
                lostItemForm.reset();
                
                // Show toast with action button and verification code
                const message = `Your lost item has been reported successfully! Your verification code is "${verificationCode}". Please save it as you will need it later.`;
                showToast(message, 'success', {
                    text: 'View Details',
                    callback: () => {
                        showReportDetailsModal(reportData);
                    }
                });
                
                // Check for matching found items
                matchingFoundItems = await findMatchingItems(item, 'found');
                if (matchingFoundItems.length > 0) {
                    const matchMessage = `We found ${matchingFoundItems.length} matching item(s) that were reported found!`;
                    
                    // Show toast with action button
                    showToast(matchMessage, 'success', {
                        text: 'View Matching Items',
                        callback: () => {
                            showMatchingItemsModal(matchingFoundItems);
                        }
                    });
                }
            } catch (error) {
                console.error('Error reporting lost item:', error);
                showToast('Failed to report lost item. Please try again.', 'error');
            }
        });
        
        // Report Found Item
        foundItemForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const item = document.getElementById('found-item').value;
            const location = document.getElementById('found-location').value;
            const description = document.getElementById('found-description').value;
            const contact = document.getElementById('found-contact').value;
            
            // Check if image is processed
            if (!isImageProcessed || !uploadedImageUrl) {
                showToast('Please upload an image of the found item', 'error');
                return;
            }
            
            try {
                // Generate verification code
                const verificationCode = generateVerificationCode();
                
                const newReportRef = database.ref('reports').push();
                const reportData = {
                    type: 'found',
                    item: item, // Keep original formatting
                    location: location, // Keep original formatting
                    description: description, // Keep original formatting
                    contact_phone: contact,
                    image_url: uploadedImageUrl, // Now a base64 string
                    verification_code: verificationCode,
                    claimed: false,
                    reporter: 'website',
                    timestamp: new Date().toISOString()
                };
                
                // Save to database
                await newReportRef.set(reportData);
                
                // Reset form immediately
                foundItemForm.reset();
                resetImagePreview();
                
                // Show success toast with verification code
                const message = `🎉 Success! Your found item has been reported. Verification Code: <strong>${verificationCode}</strong>. Please save this code!`;
                showToast(message, 'success', {
                    text: 'View Details',
                    callback: () => {
                        showReportDetailsModal(reportData);
                    }
                });
                
                // Show safety warning after a delay
                setTimeout(() => {
                    const safetyMessage = `⚠️ IMPORTANT: When someone contacts you to claim this item, please ask for verification details (color, brand, unique features) to confirm ownership. Do not return the item without proper verification.`;
                    showToast(safetyMessage, 'success');
                }, 3000);
                
            } catch (error) {
                console.error('Error reporting found item:', error);
                showToast('Failed to report found item. Please try again.', 'error');
            }
        });
        
        // Search for Items
        searchBtn.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') performSearch();
        });
        
        async function performSearch() {
            const searchTerm = searchInput.value.trim().toLowerCase();
            const filter = filterType.value;
            
            if (!searchTerm) {
                showToast('Please enter a search term', 'error');
                return;
            }
            
            currentSearchTerm = searchTerm;
            searchLoading.classList.add('active');
            searchResults.innerHTML = '';
            
            try {
                const snapshot = await database.ref('reports').once('value');
                const reports = snapshot.val();
                
                if (!reports) {
                    showNoResults(searchTerm);
                    searchLoading.classList.remove('active');
                    return;
                }
                
                const results = [];
                const twoDaysAgo = new Date();
                twoDaysAgo.setDate(twoDaysAgo.getDate() - 2);
                
                Object.entries(reports).forEach(([key, report]) => {
                    // Filter out items that were claimed/recovered more than 2 days ago
                    if ((report.claimed && report.claimed_at && new Date(report.claimed_at) < twoDaysAgo) ||
                        (report.recovered && report.recovered_at && new Date(report.recovered_at) < twoDaysAgo)) {
                        return;
                    }
                    
                    if (filter !== 'all' && report.type !== filter) return;
                    
                    const searchText = `${report.item} ${report.location} ${report.description || ''}`.toLowerCase();
                    if (searchText.includes(searchTerm)) {
                        results.push({ ...report, id: key });
                    }
                });
                
                // Sort results by timestamp (most recent first)
                results.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                if (results.length === 0) {
                    showNoResults(searchTerm);
                } else {
                    displaySearchResults(results, searchTerm);
                }
            } catch (error) {
                console.error('Error searching items:', error);
                showToast('Failed to search items. Please try again.', 'error');
            } finally {
                searchLoading.classList.remove('active');
            }
        }
        
        // Display search results
        function displaySearchResults(results, searchTerm) {
            let resultsHtml = `
                <div class="search-results-header">
                    <h4 class="search-results-title">Found ${results.length} item(s) matching "${searchTerm}"</h4>
                    <div class="search-results-actions">
                        <select class="search-sort-select" id="sort-select">
                            <option value="newest">Newest First</option>
                            <option value="oldest">Oldest First</option>
                            <option value="alphabetical">Alphabetical</option>
                        </select>
                        <button class="clear-search-btn" id="clear-search-btn">
                            <i class="bi bi-x-circle"></i> Clear
                        </button>
                    </div>
                </div>
            `;
            
            results.forEach(report => {
                const date = new Date(report.timestamp).toLocaleString();
                const isClaimed = report.claimed || false;
                const isRecovered = report.recovered || false;
                const cardClass = isClaimed ? 'claimed' : (isRecovered ? 'recovered' : '');
                
                if (report.type === 'found') {
                    const badgeClass = isClaimed ? 'badge-claimed' : 'badge-found';
                    const badgeText = isClaimed ? 'Claimed' : 'Found';
                    const badgeIcon = isClaimed ? 'bi-check-circle-fill' : 'bi-gift-fill';
                    
                    // Always show image for found items
                    const imageUrl = report.image_url;
                    
                    resultsHtml += `
                        <div class="result-item ${cardClass}">
                            <div class="result-header-with-image">
                                ${imageUrl && imageUrl.startsWith('data:image') ? 
                                    `<img src="${imageUrl}" alt="${report.item}" class="result-image">` : 
                                    '<img src="https://via.placeholder.com/80x80?text=No+Image" alt="No Image" class="result-image">'
                                }
                                <div class="result-content">
                                    <div class="result-header">
                                        <h5 class="result-title">
                                            <i class="bi bi-gift"></i>
                                            ${report.item}
                                        </h5>
                                        <span class="result-badge ${badgeClass}">
                                            <i class="bi ${badgeIcon}"></i>
                                            ${badgeText}
                                        </span>
                                    </div>
                                    <div class="result-meta">
                                        <div class="result-meta-item">
                                            <i class="bi bi-geo-alt"></i>
                                            <span>${report.location}</span>
                                        </div>
                                        <div class="result-meta-item">
                                            <i class="bi bi-clock"></i>
                                            <span>${date}</span>
                                        </div>
                                    </div>
                                    ${report.description ? `<div class="result-description">${report.description}</div>` : ''}
                                </div>
                            </div>
                            <div class="result-contact">
                                <i class="bi bi-whatsapp"></i>
                                <a href="https://wa.me/${report.contact_phone.replace(/^0/, '234')}" target="_blank">
                                    Contact via WhatsApp: ${report.contact_phone}
                                </a>
                            </div>
                            <div class="result-actions">
                                ${isClaimed ? `
                                    <div class="result-status status-success">
                                        <i class="bi bi-check-circle-fill"></i>
                                        <span>Successfully Claimed</span>
                                    </div>
                                ` : `
                                    <div class="result-buttons">
                                        <button class="btn btn-result btn-claim mark-claimed-btn" data-id="${report.id}" data-phone="${report.contact_phone}">
                                            <i class="bi bi-check-circle"></i>
                                            Mark as Claimed
                                        </button>
                                    </div>
                                `}
                            </div>
                        </div>
                    `;
                } else {
                    const badgeClass = isRecovered ? 'badge-recovered' : 'badge-lost';
                    const badgeText = isRecovered ? 'Recovered' : 'Lost';
                    const badgeIcon = isRecovered ? 'bi-check-circle-fill' : 'bi-search';
                    
                    resultsHtml += `
                        <div class="result-item ${cardClass}">
                            <div class="result-header">
                                <h5 class="result-title">
                                    <i class="bi bi-search"></i>
                                    ${report.item}
                                </h5>
                                <span class="result-badge ${badgeClass}">
                                    <i class="bi ${badgeIcon}"></i>
                                    ${badgeText}
                                </span>
                            </div>
                            <div class="result-meta">
                                <div class="result-meta-item">
                                    <i class="bi bi-geo-alt"></i>
                                    <span>${report.location}</span>
                                </div>
                                ${report.last_seen ? `
                                <div class="result-meta-item">
                                    <i class="bi bi-eye"></i>
                                    <span>Last seen: ${report.last_seen}</span>
                                </div>
                                ` : ''}
                                <div class="result-meta-item">
                                    <i class="bi bi-clock"></i>
                                    <span>${date}</span>
                                </div>
                            </div>
                            ${report.description ? `<div class="result-description">${report.description}</div>` : ''}
                            ${report.contact_info ? `
                            <div class="result-contact">
                                <i class="bi bi-whatsapp"></i>
                                <a href="https://wa.me/${report.contact_info.replace(/^0/, '234')}" target="_blank">
                                    Contact via WhatsApp: ${report.contact_info}
                                </a>
                            </div>
                            ` : ''}
                            <div class="result-actions">
                                ${isRecovered ? `
                                    <div class="result-status status-info">
                                        <i class="bi bi-check-circle-fill"></i>
                                        <span>Successfully Recovered</span>
                                    </div>
                                ` : `
                                    <div class="result-buttons">
                                        <button class="btn btn-result btn-recover mark-recovered-btn" data-id="${report.id}" data-phone="${report.contact_info}">
                                            <i class="bi bi-check-circle"></i>
                                            Mark as Recovered
                                        </button>
                                    </div>
                                `}
                            </div>
                        </div>
                    `;
                }
            });
            
            searchResults.innerHTML = resultsHtml;
            
            // Add event listeners to "Mark as Claimed" buttons
            document.querySelectorAll('.mark-claimed-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = this.getAttribute('data-id');
                    const itemPhone = this.getAttribute('data-phone');
                    currentItemToClaim = { id: itemId, phone: itemPhone };
                    
                    // Clear the verification code input and error message
                    verificationCodeInput.value = '';
                    verificationError.classList.remove('show');
                    
                    verificationModal.show();
                });
            });
            
            // Add event listeners to "Mark as Recovered" buttons
            document.querySelectorAll('.mark-recovered-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = this.getAttribute('data-id');
                    const itemPhone = this.getAttribute('data-phone');
                    currentItemToRecover = { id: itemId, phone: itemPhone };
                    
                    // Clear the verification code input and error message
                    lostVerificationCodeInput.value = '';
                    lostVerificationError.classList.remove('show');
                    
                    lostVerificationModal.show();
                });
            });
            
            // Add event listener to sort select
            const sortSelect = document.getElementById('sort-select');
            if (sortSelect) {
                sortSelect.addEventListener('change', function() {
                    sortSearchResults(this.value);
                });
            }
            
            // Add event listener to clear search button
            const clearSearchBtn = document.getElementById('clear-search-btn');
            if (clearSearchBtn) {
                clearSearchBtn.addEventListener('click', function() {
                    searchInput.value = '';
                    searchResults.innerHTML = '';
                    currentSearchTerm = '';
                });
            }
        }
        
        // Show no results state
        function showNoResults(searchTerm) {
            const noResultsHtml = `
                <div class="no-results">
                    <div class="no-results-icon">
                        <i class="bi bi-search"></i>
                    </div>
                    <h3 class="no-results-title">No items found</h3>
                    <p class="no-results-text">
                        We couldn't find any items matching "${searchTerm}". Try using different keywords or check your spelling.
                    </p>
                    <div class="no-results-suggestions">
                        <h6><i class="bi bi-lightbulb"></i> Search Tips</h6>
                        <ul>
                            <li>Try using more general terms (e.g., "phone" instead of "iPhone 13 Pro")</li>
                            <li>Check for typos in your search term</li>
                            <li>Try searching by location (e.g., "library", "cafeteria")</li>
                            <li>Browse all items by leaving the search field empty and clicking "Search"</li>
                        </ul>
                    </div>
                </div>
            `;
            
            searchResults.innerHTML = noResultsHtml;
        }
        
        // Sort search results
        function sortSearchResults(sortBy) {
            const resultItems = Array.from(document.querySelectorAll('.result-item'));
            const resultsContainer = document.querySelector('.search-results');
            
            // Remove existing result items
            resultItems.forEach(item => item.remove());
            
            // Get the current results data
            const currentResults = [];
            resultItems.forEach(item => {
                // Extract data from the DOM element
                const title = item.querySelector('.result-title').textContent.trim();
                const dateText = item.querySelector('.result-meta-item:nth-child(2) span').textContent;
                const date = new Date(dateText);
                
                currentResults.push({
                    element: item,
                    title: title,
                    date: date
                });
            });
            
            // Sort based on the selected option
            switch (sortBy) {
                case 'oldest':
                    currentResults.sort((a, b) => a.date - b.date);
                    break;
                case 'alphabetical':
                    currentResults.sort((a, b) => a.title.localeCompare(b.title));
                    break;
                case 'newest':
                default:
                    currentResults.sort((a, b) => b.date - a.date);
                    break;
            }
            
            // Re-append the sorted elements
            const resultsHeader = resultsContainer.querySelector('.search-results-header');
            currentResults.forEach(result => {
                resultsContainer.appendChild(result.element);
            });
        }
        
        // Find matching items (for lost item reporting)
        async function findMatchingItems(searchItem, type) {
            try {
                const snapshot = await database.ref('reports').once('value');
                const reports = snapshot.val();
                
                if (!reports) return [];
                
                const searchKeywords = searchItem.toLowerCase().split(' ');
                const matchingItems = [];
                
                Object.entries(reports).forEach(([key, report]) => {
                    if (report.type === type) {
                        const reportText = `${report.item} ${report.description || ''}`.toLowerCase();
                        const matchScore = searchKeywords.reduce((score, keyword) => {
                            return score + (reportText.includes(keyword) ? 1 : 0);
                        }, 0);
                        
                        if (matchScore > 0) {
                            matchingItems.push({...report, matchScore});
                        }
                    }
                });
                
                return matchingItems.sort((a, b) => b.matchScore - a.matchScore);
            } catch (error) {
                console.error('Error finding matching items:', error);
                return [];
            }
        }
        
        // Handle "Confirm and Mark as Claimed" button
        confirmClaimBtn.addEventListener('click', async () => {
            if (!currentItemToClaim) return;
            
            const enteredCode = verificationCodeInput.value.trim().toUpperCase();
            
            if (!enteredCode) {
                showToast('Please enter your verification code', 'error');
                return;
            }
            
            try {
                // Get the report to verify the code
                const reportSnapshot = await database.ref(`reports/${currentItemToClaim.id}`).once('value');
                const reportData = reportSnapshot.val();
                
                if (!reportData) {
                    showToast('Report not found', 'error');
                    return;
                }
                
                // Verify the code
                if (reportData.verification_code !== enteredCode) {
                    // Show error message inside the modal instead of toast
                    verificationError.classList.add('show');
                    return;
                }
                
                // Mark as claimed
                await database.ref(`reports/${currentItemToClaim.id}`).update({
                    claimed: true,
                    claimed_at: new Date().toISOString()
                });
                
                verificationModal.hide();
                showToast('Item has been marked as claimed successfully!');
                
                // Refresh search results if visible
                if (searchResults.innerHTML !== '' && currentSearchTerm) {
                    performSearch();
                }
                
                currentItemToClaim = null;
            } catch (error) {
                console.error('Error marking item as claimed:', error);
                showToast('Failed to mark item as claimed. Please try again.', 'error');
            }
        });
        
        // Handle "Confirm and Mark as Recovered" button
        confirmRecoveredBtn.addEventListener('click', async () => {
            if (!currentItemToRecover) return;
            
            const enteredCode = lostVerificationCodeInput.value.trim().toUpperCase();
            
            if (!enteredCode) {
                showToast('Please enter your verification code', 'error');
                return;
            }
            
            try {
                // Get the report to verify the code
                const reportSnapshot = await database.ref(`reports/${currentItemToRecover.id}`).once('value');
                const reportData = reportSnapshot.val();
                
                if (!reportData) {
                    showToast('Report not found', 'error');
                    return;
                }
                
                // Verify the code
                if (reportData.verification_code !== enteredCode) {
                    // Show error message inside the modal instead of toast
                    lostVerificationError.classList.add('show');
                    return;
                }
                
                // Mark as recovered
                await database.ref(`reports/${currentItemToRecover.id}`).update({
                    recovered: true,
                    recovered_at: new Date().toISOString()
                });
                
                lostVerificationModal.hide();
                showToast('Item has been marked as recovered successfully!');
                
                // Refresh search results if visible
                if (searchResults.innerHTML !== '' && currentSearchTerm) {
                    performSearch();
                }
                
                currentItemToRecover = null;
            } catch (error) {
                console.error('Error marking item as recovered:', error);
                showToast('Failed to mark item as recovered. Please try again.', 'error');
            }
        });
        
        // Sticky header functionality
        window.addEventListener('scroll', () => {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            // Update scroll progress bar
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrollPercent = (scrollTop / scrollHeight) * 100;
            scrollProgress.style.width = `${scrollPercent}%`;
            
            // Show/hide back to top button
            if (scrollTop > 300) {
                backToTop.classList.add('visible');
            } else {
                backToTop.classList.remove('visible');
            }
            
            // Show/hide sticky header based on scroll direction
            if (scrollTop > heroSection.offsetHeight) {
                stickyHeader.classList.add('visible');
            } else {
                stickyHeader.classList.remove('visible');
            }
            
            lastScrollTop = scrollTop;
        });
        
        // Back to top button functionality
        backToTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // Initialize
        window.addEventListener('load', () => {
            createParticles();
        });
    </script>
</body>
</html>
